# ===========================
# 🔧 INFRA/CORE - 인프라 핵심 설정
# ===========================

# Database (상대경로 - 프로젝트 루트 기준)
# 사용 모듈: infra/core/database - SQLite 데이터베이스 연결 및 스키마 관리용
DATABASE_PATH=./data/graphapi.db

# Security
# 사용 모듈: infra/core/config, modules/account - 데이터 암호화용
# 생성 방법: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ENCRYPTION_KEY=your_encryption_key_here

# Logging
# 사용 모듈: infra/core/logger - 전역 로깅 레벨 설정용
LOG_LEVEL=INFO

# Network
# 사용 모듈: infra/core/oauth_client - HTTP 요청 타임아웃 설정 (초 단위)
HTTP_TIMEOUT=30

# Token
# 사용 모듈: infra/core/token_service - 토큰 갱신 시점 결정용 (분 단위)
TOKEN_REFRESH_BUFFER_MINUTES=10

# Environment
# 사용 모듈: infra/core/config - 애플리케이션 실행 환경 구분용
ENVIRONMENT=development



# ===========================
# 📩 MODULES/DCR - Dynamic Client Registration OAuth
# ===========================
# DCR (Dynamic Client Registration) OAuth Configuration
# 사용 모듈: modules/dcr_oauth - Claude Connector OAuth 인증용
# Claude Custom Connector를 통한 MCP 서버 인증에 필요한 설정
#
# OAuth 인증 활성화 (true/false)
ENABLE_OAUTH_AUTH=false
#
# DCR을 위한 Azure AD 앱 정보 (계정별 설정이 없을 경우 기본값으로 사용)
# Azure Portal에서 앱 등록 후 얻은 정보를 입력하세요
# https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps
DCR_AZURE_CLIENT_ID=your_azure_app_client_id
DCR_AZURE_CLIENT_SECRET=your_azure_app_client_secret
DCR_AZURE_TENANT_ID=common  # 또는 실제 테넌트 ID (예: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)
DCR_OAUTH_REDIRECT_URI=https://your-server.trycloudflare.com/auth/callback
DCR_OAUTH_SCOPE=offline_access User.Read Mail.ReadWrite Mail.Send

# 허용된 사용자 목록 (선택사항)
# 쉼표로 구분된 이메일 목록. 비어있으면 모든 사용자 허용
# 예: user1@company.com,user2@company.com,admin@company.com
DCR_ALLOWED_USERS=

# DCR OAuth 인증 후 graphapi.db accounts 테이블 동기화 활성화
# true: DCR 인증 시 자동으로 graphapi.db의 accounts 테이블에 계정 정보 동기화
# false: DCR 인증만 하고 graphapi.db 동기화 건너뛰기
ENABLE_DCR_ACCOUNT_SYNC=true



# ===========================
# 📩 MODULES/ENROLLMENT - 계정 등록 모듈
# ===========================

ENROLLMENT_DIRECTORY=./enrollment

# 자동 계정 등록 (선택사항 - 환경변수로 계정 설정 시 사용)
AUTO_REGISTER_USER_ID=your_user_id
AUTO_REGISTER_USER_NAME=Your Name
AUTO_REGISTER_EMAIL=your.email@example.com
AUTO_REGISTER_OAUTH_CLIENT_ID=your_azure_app_client_id
AUTO_REGISTER_OAUTH_CLIENT_SECRET=your_azure_app_client_secret
AUTO_REGISTER_OAUTH_TENANT_ID=common
AUTO_REGISTER_OAUTH_REDIRECT_URI=https://your-server.trycloudflare.com/enrollment/callback
AUTO_REGISTER_DELEGATED_PERMISSIONS=Mail.ReadWrite,Mail.Send,offline_access,Files.Read,Files.ReadWrite,Calendars.Read,Calendars.ReadWrite,Chat.Read,Chat.ReadWrite,Notes.Read,Notes.ReadWrite,Notes.Create

# 추가 권한 예시:
# Files.ReadWrite.All,Sites.ReadWrite.All,Sites.Selected,Team.ReadBasic.All



# ===========================
# ⚙️ MODULES/MAIL_PROCESS - 메일 처리 모듈
# ===========================

# Processing Limits
# 사용 모듈: modules/mail_processor - 메일 처리 시 최대 키워드 수
MAX_KEYWORDS_PER_MAIL=5
# 사용 모듈: modules/mail_processor - 계정당 최대 메일 처리 수
MAX_MAILS_PER_ACCOUNT=200
# 사용 모듈: modules/mail_query - 이메일 조회 배치 크기 설정용
MAIL_BATCH_SIZE=100

# Filtering Rules
# 사용 모듈: modules/mail_processor/mail_filter_service - 메일 필터링 규칙 설정용
# 차단할 도메인 목록 (쉼표로 구분)
BLOCKED_DOMAINS=noreply.com,no-reply.com,donotreply.com,notifications.com,alerts.com
# 차단할 키워드 목록 (쉼표로 구분)
BLOCKED_KEYWORDS=스팸,광고,홍보,마케팅,unsubscribe,newsletter,promotion
# 차단할 발신자 패턴 목록 (쉼표로 구분)
BLOCKED_SENDER_PATTERNS=noreply@,no-reply@,donotreply@,auto-reply@,block@

# 필터링 활성화 여부
ENABLE_MAIL_FILTERING=true
# 의심스러운 발신자 패턴 검사 활성화 여부
ENABLE_SUSPICIOUS_SENDER_CHECK=true



# ===========================
# 💾 FILE STORAGE - 파일 저장 설정
# ===========================

# 첨부파일 저장 모드 (local, onedrive, sharepoint)
# local: 로컬 filtered_attachments 폴더에 저장
# onedrive: OneDrive에 업로드
# sharepoint: SharePoint 폴더에 업로드
ATTACHMENT_STORAGE_MODE=onedrive

# SharePoint 폴더 공유 URL (attachmentManager 기본 저장 위치)
# 비어있으면 로컬 filtered_attachments 폴더에만 저장
SHAREPOINT_FOLDER_URL=



# ===========================
# 🤖 AI/ML - AI 서비스 설정 (선택사항)
# ===========================

# OpenAI API Configuration
# 사용 모듈: modules/keyword_extractor - 키워드 추출 및 텍스트 분석용
OPENAI_API_KEY=your_openai_api_key_here

# OpenRouter API Configuration
# 사용 모듈: modules/mail_processor - 메일 키워드 추출용
OPENROUTER_API_KEY=your_openrouter_api_key_here
OPENROUTER_MODEL=openai/o3-mini
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1



# ===========================
# 📊 VECTOR DB - Qdrant 설정 (선택사항)
# ===========================

# Qdrant Configuration
# 사용 모듈: modules/templates/uploaders/vector_uploader - Qdrant 벡터 DB 설정
QDRANT_URL=localhost
QDRANT_PORT=6333
# 사용 모듈: modules/templates/uploaders/vector_uploader - 템플릿 저장용 컬렉션 이름
# 기본값: query_templates_unified
QDRANT_COLLECTION_NAME=query_templates



# ===========================
# 📨 KAFKA - 메시징 설정 (선택사항)
# ===========================

# Kafka Configuration
# 사용 모듈: infra/core/kafka_client - 이메일 이벤트 메시징용
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_TOPIC_EMAIL_EVENTS=email-raw-data

# Kafka Consumer Settings
# 사용 모듈: infra/core/kafka_client - Kafka 컨슈머 그룹 ID
KAFKA_CONSUMER_GROUP_ID=mailquery-dev
# 사용 모듈: infra/core/kafka_client - Kafka 연결 타임아웃 설정 (초 단위)
KAFKA_TIMEOUT=30



# ===========================
# 🔧 LEGACY/DEPRECATED - 레거시 설정 (사용하지 않음)
# ===========================

# OAuth Legacy Settings (enrollment 모듈에서 AUTO_REGISTER_* 사용)
# OAUTH_REDIRECT_PORT=5000
# OAUTH_REDIRECT_PATH=/auth/callback

# Mail History (현재 미사용)
# ENABLE_MAIL_HISTORY=true
